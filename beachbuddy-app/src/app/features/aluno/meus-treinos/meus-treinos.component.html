<section class="aluno-header">
  <div>
    <h1>Meus Treinos</h1>
    <p>Aqui você acompanha suas inscrições e pode cancelar quando necessário.</p>
  </div>
  <div class="aluno-actions">
    <a class="btn" routerLink="/aluno/novo-treino">+ Novo treino</a>
  </div>
</section>

<section class="aluno-stats" aria-label="Resumo">
  <div class="aluno-stat">
    <span>Total de inscrições</span>
    <strong>{{ inscricoes().length }}</strong>
  </div>
  <div class="aluno-stat">
    <span>Ativas</span>
    <strong>{{ ativasCount() }}</strong>
  </div>
</section>

@if (ativasCount() > 0) {
<section class="inscricoes-grid" aria-live="polite">
  @for (i of inscricoesAtivas(); track i.id) {
  <article class="inscricao-card">
    <header class="inscricao-card__header">
      <h2>{{ i.treino_detalhes?.modalidade || 'Treino #' + i.treino }}</h2>
      <span class="inscricao-card__date">{{ i.treino_detalhes?.data | date:'dd/MM/yyyy' }} · {{ i.treino_detalhes?.hora_inicio }} - {{ i.treino_detalhes?.hora_fim }}</span>
    </header>
    
    <dl class="inscricao-card__details">
      <div>
        <dt>Centro</dt>
        <dd>{{ i.treino_detalhes?.ct_nome || '—' }}</dd>
      </div>
      <div>
        <dt>Nível</dt>
        <dd>{{ i.treino_detalhes?.nivel || '—' }}</dd>
      </div>
      <div>
        <dt>Inscritos</dt>
        <dd>{{ ((i.treino_detalhes?.vagas ?? 0) - (i.treino_detalhes?.vagas_disponiveis ?? 0)) }}/{{ i.treino_detalhes?.vagas ?? 0 }}</dd>
      </div>
    </dl>

    <div class="inscricao-status-wrapper">
      @if (i.status === 'CONFIRMADA') {
      <span class="inscricao-status inscricao-status--confirmada">✓ Confirmada</span>
      } @else if (i.status === 'PENDENTE') {
      <span class="inscricao-status inscricao-status--pendente">⏱ Pendente</span>
      } @else {
      <span class="inscricao-status inscricao-status--cancelada">✕ Cancelada</span>
      }
    </div>

    <div class="inscricao-actions">
      @if (i.status !== 'CANCELADA') {
      <button type="button" (click)="cancelar(i.id)" class="btn btn-outline btn-sm">Cancelar inscrição</button>
      }
    </div>
  </article>
  }
</section>
} @else {
<div class="empty-box">
  <h2>Nenhuma inscrição ainda</h2>
  <p>Você ainda não se inscreveu em nenhum treino. Que tal começar agora?</p>
  <a class="btn" routerLink="/aluno/novo-treino">Encontrar treinos</a>
</div>
}