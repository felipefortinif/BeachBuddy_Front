<section class="ct-page">
  <header class="ct-page__header">
    <div>
      <h1 class="ct-page__title">
        @if (isProfessor()) {
        Meus centros de treinamento
        } @else {
        Centros de treinamento
        }
      </h1>
      <p class="ct-page__subtitle">
        @if (isProfessor()) {
        Visualize rapidamente os dados dos CTs em que voc√™ ministra treinos.
        } @else {
        Conhe√ßa os espa√ßos parceiros do Beach Buddy e confira as modalidades oferecidas.
        }
      </p>
    </div>
    @if (isGerente()) {
    <a routerLink="/gerente/novo-ct" class="btn">Novo CT</a>
    }
  </header>

  <!-- Mapa interativo dos CTs -->
  @if (ctsComLocalizacao().length > 0) {
  <div class="ct-map-section">
    <h2>üìç Encontre um CT perto de voc√™</h2>
    <p class="map-subtitle">Clique nos marcadores para ver detalhes e navegar pelo mapa do Rio de Janeiro</p>
    <app-ct-map 
      [cts]="ctsComLocalizacao()" 
      [height]="'450px'">
    </app-ct-map>
  </div>
  }

  @if (cts()) {
  <div class="ct-grid" aria-live="polite">
    @for (ct of cts(); track ct.id) {
    <article class="ct-card">
      <header class="ct-card__header">
        <div>
          <h2>{{ ct.nome }}</h2>
          @if (ct.gerente) {
          <span class="ct-card__meta">Gerente: {{ ct.gerente_nome }}</span>
          }
        </div>
        @if (isGerente() && ct.gerente === currentUserId()) {
        <div class="ct-card__actions">
          <a [routerLink]="['/cts', ct.id, 'editar']" class="btn btn-sm">Editar</a>
          <a [routerLink]="['/cts', ct.id, 'excluir']" class="btn btn-outline btn-sm">Excluir</a>
        </div>
        }
      </header>

      <dl class="ct-card__details">
        <div>
          <dt>Endere√ßo</dt>
          <dd>{{ ct.endereco }}</dd>
        </div>
        <div>
          <dt>Contato</dt>
          <dd>{{ ct.contato }}</dd>
        </div>
        <div>
          <dt>Modalidades</dt>
          <dd>
            <pre style="white-space: pre-wrap; margin: 0; font-family: inherit;">{{ ct.modalidades }}</pre>
          </dd>
        </div>
        <div>
          <dt>Professores associados</dt>
          <dd>
            @if (ct.professores) {
            {{ ct.professores.length }}
            } @else {
            Nenhum cadastrado
            }
          </dd>
        </div>
        <div>
          <dt>Treinos futuros</dt>
          <dd>
            @if (getTreinosFuturos(ct.id) > 0) {
            {{ getTreinosFuturos(ct.id) }} agendado{{ getTreinosFuturos(ct.id) > 1 ? 's' : '' }}
            } @else {
            Nenhum agendado
            }
          </dd>
        </div>
      </dl>

      <footer class="ct-card__footer">
        <a [routerLink]="['/cts', ct.id]" class="btn btn-outline btn-sm">Ver agenda completa</a>
      </footer>
    </article>
    }
  </div>
  } @else {
  <div class="empty-state">
    @if (isProfessor()) {
    <h2>Voc√™ ainda n√£o foi vinculado a nenhum CT.</h2>
    <p>Pe√ßa ao gerente respons√°vel para adicion√°-lo √† equipe do centro.</p>
    } @else {
    <h2>Nenhum centro cadastrado no momento.</h2>
    <p>Volte em breve para conhecer novos parceiros.</p>
    }
  </div>
  }
</section>